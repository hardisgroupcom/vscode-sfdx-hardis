<template>
    <template if:true={isVisible}>
        <div class="prompt-inline-container" onkeydown={handleKeyDown}>
            <div class="prompt-card">
                <!-- Prompt Message -->
                <div class="prompt-header">
                    <span class="prompt-message-content"></span>
                </div>

                <!-- Error Message -->
                <template if:true={error}>
                    <div class="error-message">
                        <div class="slds-notify slds-notify_alert slds-theme_error" role="alert">
                            <span class="slds-assistive-text">Error</span>
                            <span>{error}</span>
                        </div>
                    </div>
                </template>

                <!-- Text Input -->
                <template if:true={isTextInput}>
                    <div class="input-section">
                        <lightning-input
                            type="text"
                            label="Your Input"
                            placeholder={promptPlaceholder}
                            value={inputValue}
                            onchange={handleInputChange}
                            onkeydown={handleKeyDown}>
                        </lightning-input>
                    </div>
                </template>

                <!-- Number Input -->
                <template if:true={isNumberInput}>
                    <div class="input-section">
                        <lightning-input
                            type="number"
                            label="Your Input"
                            placeholder={promptPlaceholder}
                            value={inputValue}
                            step={numberStep}
                            onchange={handleInputChange}
                            onkeydown={handleKeyDown}>
                        </lightning-input>
                    </div>
                </template>

                <!-- Select Input -->
                <template if:true={isSelectInput}>
                    <div class="input-section">
                        <lightning-combobox
                            label="Select an option"
                            placeholder="Choose an option..."
                            options={selectOptions}
                            value={selectedValue}
                            onchange={handleSelectChange}
                            onkeydown={handleKeyDown}
                            class="prompt-combobox">
                        </lightning-combobox>
                        <!-- Display description for selected option -->
                        <template if:true={selectedOptionDescription}>
                            <div class="option-description">
                                {selectedOptionDescription}
                            </div>
                        </template>
                    </div>
                </template>

                <!-- Multiselect Input -->
                <template if:true={isMultiselectInput}>
                    <div class="input-section">
                        <fieldset class="slds-form-element">
                            <legend class="slds-form-element__legend slds-form-element__label">
                                Select options (multiple allowed)
                            </legend>
                            <div class="slds-form-element__control">
                                <template for:each={multiselectOptions} for:item="option">
                                    <div key={option.value} class="checkbox-option">
                                        <lightning-input
                                            type="checkbox"
                                            label={option.label}
                                            value={option.value}
                                            checked={option.checked}
                                            onchange={handleMultiselectChange}
                                            onkeydown={handleKeyDown}>
                                        </lightning-input>
                                        <template if:true={option.description}>
                                            <div class="option-description-small">
                                                {option.description}
                                            </div>
                                        </template>
                                    </div>
                                </template>
                            </div>
                        </fieldset>
                    </div>
                </template>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <div class="keyboard-hint">
                        Press Enter to submit, Esc to cancel
                    </div>
                    <div class="action-buttons-right">
                        <lightning-button
                            variant="brand"
                            label="Submit"
                            icon-name="utility:check"
                            onclick={handleSubmit}
                            class="action-button">
                        </lightning-button>
                        <lightning-button
                            variant="neutral"
                            label="Cancel"
                            icon-name="utility:close"
                            onclick={handleCancel}
                            class="action-button">
                        </lightning-button>
                    </div>
                </div>
            </div>
        </div>
    </template>
</template>
